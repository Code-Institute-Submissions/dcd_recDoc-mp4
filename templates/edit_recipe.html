{% extends 'base.html'%} {% block content %}

<h3 class = "center-align">Edit Recipe</h3>
<div class="row">
    <form action="{{ url_for('update_recipe', recipe_id=recipe._id) }}" method="POST" class="col s12">
          <!--provide select option-->
        <div class="row">
            <div class="input-field col s12">
                <i class="material-icons prefix">poll</i>
                <select id="category" name="category_name">
                  <option value="" disabled selected>Choose Category</option>
            <!--iterate through document and show categories of which one is selected-->     
                  {% for cat in categories %}
                      {% if cat.category_name == recipe.category_name%}
                      <option value="{{cat.category_name}}" selected >{{cat.category_name}}</option>
                      {% else %}
                       <option value="{{cat.category_name}}">{{cat.category_name}}</option>
                    {% endif %}
                  {% endfor %}
                </select>
                <label>Recipe Category</label>
            </div>
        </div>
       <!--code for recipe name-->
        <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">assignment</i>
              <input id="Recipe_name" name = "Recipe_name" type="text" class="validate" required autocomplete="off"  placeholder="For example Beef stew (numbers can also be used, but no special characters (such as Â£, $, ^)" pattern="[a-zA-Z0-9 -*&()[]{}@?]{1,}" value="{{recipe.Recipe_name}}">
              <label for="icon_prefix">Recipe Name</label>
            </div>
        </div>
<!--code for recipe total prep and cooking time-->
        <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">access_time</i>
              <input id="Total_time" name = "Total_time" type="number" class="validate" required autocomplete="off"  placeholder="Enter as mins (for example 40)" pattern="[0-9}" Title = "Enter a Number" value="{{recipe.Total_time}}">
              <label for="icon_prefix">Total Prep and Cook Time (in minutes)</label>
            </div>
        </div>
        
 <!--code for recipe prep time-->
         <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">access_time</i>
              <input id="Prep_time" name = "Prep_time" type="number" class="validate" autocomplete="off"  placeholder="Enter as mins (for example 40)" pattern="[0-9}" Title = "Enter a Number" value="{{recipe.Prep_time}}">
              <label for="icon_prefix">Prep Time (in minutes)</label>
            </div>
        </div>
         
 <!--code for recipe cooking time-->
         <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">access_time</i>
              <input id="Cooking_time" name = "Cooking_time" type="number" class="validate" autocomplete="off"  placeholder="Enter as mins (for example 40)" pattern="[0-9}" Title = "Enter a Number" value="{{recipe.Prep_time}}">
              <label for="icon_prefix">Cooking Time</label>
            </div>
        </div>
         
<!--code for suitability of recipe to Vegeterians and Vegans-->
        <div class="input-field col s12">
              <i class="material-icons prefix">restaurant</i>
              <input id="Suitable_for_Vegetarians" name = "Suitable_for_Vegetarians" type="text" class="validate" autocomplete="off"  required placeholder="Yes or No" pattern="[Y,e,s,N,o]{1,3}" Title= "Yes or No" value="{{recipe.Suitable_for_Vegetarians}}">
              <label for="icon_prefix">Suitable for Vegetarians</label>
            </div>
            <div class="input-field col s12">
              <i class="material-icons prefix">restaurant_menu</i>
              <input id="Suitable_for_Vegans" name = "Suitable_for_Vegans" type="text" class="validate" autocomplete="off"  required placeholder="Yes or No" pattern="[Y,e,s,N,o]{1,3}" Title= "Yes or No" value="{{recipe.Suitable_for_Vegans}}">
              <label for="icon_prefix">Suitable for Vegans</label>
            </div>
        
<!--code to allow the user to edit the recipe ingredients-->
        <div class = "row">
            <div class="input-field col s12">
              <i class="material-icons prefix">list</i>
              <textarea type="textarea" name = "Ingredients" id = "Ingredients" class = "materialize-textarea" required>{{recipe.Ingredients}}</textarea>
              <label for="icon_prefix">List of Ingredients</label>
            </div>
        </div>
<!--code to allow the user to edit the recipe instructions-->
        <div class = "row">
            <div class="input-field col s12">
              <i class="material-icons prefix">list</i>
              <textarea type="textarea" name = "Instructions" id = "Instructions" class = "materialize-textarea" required>{{recipe.Instructions}}</textarea>
              <label for="icon_prefix">List of Instructions</label>
            </div>
        </div>
<!--code to allow the user to edit the amount of servings obtained from the ingredients-->
        <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">pie_chart</i>
              <input id="Servings" name = "Servings" type="number" class="validate" autocomplete="off"  placeholder="Total servings obtained from all ingredients (for example 4)" pattern="[0-9}" Title = "Enter a Number" value="{{recipe.Servings}}">
              <label for="icon_prefix">Total Servings</label>
            </div>
        </div>
        
<!--code to allow the user to edit the calories per serving, if known-->
        <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">pie_chart</i>
              <input id="Calories_per_serving" name = "Calories_per_serving" type="number" class="validate" autocomplete="off"  placeholder="Value per 1 serving (for example 80)" pattern="[0-9}" Title = "Enter a Number" value="{{recipe.Calories_per_serving}}">
              <label for="icon_prefix">Calories per Serving (kCal)</label>
            </div>
        </div>
         
<!--code to allow the user to edit the protein per serving, if known-->
         <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">pie_chart</i>
              <input id="Protein_per_serving" name = "Protein_per_serving" type="number" class="validate" autocomplete="off"  placeholder="Value per 1 serving (for example 10)" pattern="[0-9}" Title = "Enter a Number" value="{{recipe.Protein_per_serving}}">
              <label for="icon_prefix">Protein (in grams) per serving</label>
            </div>
        </div>
        
<!--code to allow the user to edit the Carbohydrate per serving, if known-->
        <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">pie_chart</i>
              <input id="Carbohydrate_per_serving" name = "Carbohydrate_per_serving" type="number" class="validate" autocomplete="off"  placeholder="Value per 1 serving (for example 10)" pattern="[0-9}" Title = "Enter a Number" value="{{recipe.Carbohydrate_per_serving}}">
              <label for="icon_prefix">Carbohydrate (in grams) per Serving</label>
            </div>
        </div>
        
    <!--code to allow the user to edit the info on allergens--> 
   <div class ="row">
  <div class="input-field col s12">
      <i class="material-icons prefix">comment</i>
          <textarea type="textarea" name = "Allergens" id = "Allergens" class = "materialize-textarea" autocomplete="off"  required placeholder= "For example write as: Contains Nuts (Recipe may contain any of the following:  Gluten (wheat, rye, barley, oats), Crustaceans (crab, shrimp, prawn), Fish, Eggs, Nuts (peanuts, almonds, hazelnuts, walnuts, cashews, pecan nuts, Brazil nuts, pistachio nuts, macadamia), Soy (soya), Seasme Seeds, Milk, Celery, Mustard, Sulphur dioxide and sulphites, Lupin (lupin beans, lupin based flours and pastas) and Molluscs (mussel, snail, octupus, oyster, clam, whelk, squid)">{{recipe.Allergens}}</textarea>
          <label for="icon_prefix">Allergens (Write None Known if there are none. Where there are write aplhabetically in Title Case: for example; Contains Egg, Gluten, Lupin)</label>
  </div>
</div>             
<!--code to allow the user to edit the source of the recipe-->
        <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">folder</i>
              <input id="Source" name = "Source" type="text" class="validate" autocomplete="off"  required placeholder="For example may be (Website address / book name and publisher / traditional)" pattern="[a-zA-Z0-9 -*&()[]{}@?]{1,}" value="{{recipe.Source}}">
              <label for="icon_prefix">Recipe Source</label>
            </div>
        </div>
        
<!--code to allow the user to edit the author name if different to the addee-->
        <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">person</i>
              <input id="Author" name = "Author" type="text" class="validate" autocomplete="off"  placeholder="For example may be an individual or organisation" required pattern="[a-zA-Z0-9 -*&()[]{}@?]{1,}" value="{{recipe.Author}}">
              <label for="icon_prefix">Recipe Author</label>
            </div>
        </div>
        
        <!--code to allow the user to edit country of origin for the recipe-->
        <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">location_city</i>
              <input id="Country_of_origin" name = "Country_of_origin" type="text" class="validate" required autocomplete="off" pattern="[a-zA-Z0-9 -*&()[]{}@?]{1,}" value="{{recipe.Country_of_origin}}">
              <label for="icon_prefix">Country of Origin</label>
            </div>
        </div>
        
<!--code to allow the user to edit the date the recipe was added-->
        <div class="row">
            <div class="input-field col s12">
                <i class="material-icons prefix">today</i>
                <input id="Date_added" name="Date_added" type="text" class="datepicker" required>
                <label for="icon_prefix">Date Recipe Added</label>
            </div>
        </div>
 <!--code to allow the user to edit their name-->
     <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">person_outline</i>
              <input id="Added_by" name = "Added_by" type="text" class="validate" autocomplete="off"  pattern="[a-zA-Z0-9 -*&()[]{}@?]{1,}"  value="{{recipe.Added_by}}">
              <label for="icon_prefix">Added By (if different from Author)</label>
            </div>
        </div>
     
 <!--code to allow the user to add editing notes during editing-->
         <div class = "row">
            <div class="input-field col s12">
              <i class="material-icons prefix">edit</i>
              <textarea type="textarea" name = "Editing_notes" id = "Editing_notes" class = "materialize-textarea" required>{{recipe.Editing_notes}}</textarea>
              <label for="icon_prefix">Editing Notes (This is included to facilitate editing at a later date)</label>
            </div>
        </div> 
        <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">thumb_up</i>
              <input id="upvotes" name = "upvotes" input type = "number" readonly value = "{{recipe.upvotes|int}}">
              <label for="icon_prefix">Upvotes</label>
            </div>
        </div>
        <!--submit button-->
        <div class="row">
            <div class = "col s6 center-align">
                <button class="btn waves-effect waves-light" type="submit" name="action">Edit Recipe
                    <i class="material-icons right">playlist_add</i>
                 </button>
             </div>
             <div class = "col s6 center-align">
                 <button><a href="{{ url_for('get_recipes') }}" class="waves-effect waves-light btn grey">
                    <i class="material-icons right">cancel</i>Cancel
                </a>
                </button>
            </div>
        </div>
    </form>
</div>
<!--initialising scripts-->
<!--Due to a bug to bind the date associated with the task to the field; need to reproduce the script in the parent-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!--then parse date into a format that the datepicker comprehends-->
<script type="text/javascript">
    $(document).ready(function() {
        Date_added = Date.parse('{{recipe.Date_added}}');
        $('#Date_added').pickadate('picker').set('select', Date_added, { format: 'dd/mm/yyyy' }).trigger('change');
    });
</script>

{% endblock %}